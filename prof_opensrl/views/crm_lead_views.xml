<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- 1) Tutti gli utenti: campi in sola lettura -->
  <record id="view_crm_lead_form_ro_main" model="ir.ui.view">
    <field name="name">crm.lead.form.readonly.main</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="crm.crm_lead_view_form"/>
    <field name="priority">50</field>
    <field name="arch" type="xml">
      <xpath expr="//field[@name='partner_id']" position="attributes">
        <attribute name="readonly">1</attribute>
      </xpath>
      <xpath expr="//field[@name='expected_revenue']" position="attributes">
        <attribute name="invisible">1</attribute>
      </xpath>
      <xpath expr="//field[@name='probability']" position="attributes">
        <attribute name="invisible">1</attribute>
      </xpath>
      <xpath expr="//field[@name='user_id']" position="attributes">
        <attribute name="invisible">1</attribute>
      </xpath>
    </field>
  </record>

  <!-- 2) Solo il gruppo Lead Administrator: rendo i campi modificabili -->
  <record id="view_crm_lead_form_rw_for_lead_admin" model="ir.ui.view">
    <field name="name">crm.lead.form.rw.for.lead.admin</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="crm.crm_lead_view_form"/>
    <!-- limita questa ereditÃ  agli utenti del gruppo -->
    <field name="groups_id" eval="[(6, 0, [ref('crm.group_lead_admin')])]"/>
    <field name="priority">60</field>
    <field name="arch" type="xml">
      <xpath expr="//field[@name='partner_id']" position="attributes">
        <attribute name="readonly">0</attribute>
      </xpath>
     <xpath expr="//field[@name='expected_revenue']" position="attributes">
        <attribute name="invisible">0</attribute>
      </xpath>
      <xpath expr="//field[@name='probability']" position="attributes">
        <attribute name="invisible">0</attribute>
      </xpath>
      <xpath expr="//field[@name='user_id']" position="attributes">
        <attribute name="invisible">0</attribute>
      </xpath>
    </field>
  </record>

  <record id="crm_lead_search_add_state_country" model="ir.ui.view">
    <field name="name">crm.lead.search.add.state.country</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="crm.view_crm_case_leads_filter"/>
    <field name="arch" type="xml">
      <xpath expr="//search" position="inside">
        <!-- Province / Stato (subdivisione amministrativa) -->
        <field name="state_id" string="Provincia"/>
      </xpath>
    </field>
  </record>
</odoo>
