<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="crm_lead_form_admin_fields" model="ir.ui.view">
    <field name="name">crm.lead.form.admin.fields</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="crm.crm_lead_view_form"/>
    <field name="arch" type="xml">
      <xpath expr="//field[@name='partner_id']" position="attributes">
        <attribute name="groups">sales_team.group_sale_manager</attribute>
      </xpath>
      <xpath expr="//field[@name='expected_revenue']" position="attributes">
        <attribute name="groups">sales_team.group_sale_manager</attribute>
      </xpath>
      <xpath expr="//field[@name='probability']" position="attributes">
        <attribute name="groups">sales_team.group_sale_manager</attribute>
      </xpath>
      <xpath expr="//field[@name='user_id']" position="attributes">
        <attribute name="groups">sales_team.group_sale_manager</attribute>
      </xpath>
    </field>
  </record>

  <record id="crm_lead_form_deadline_label" model="ir.ui.view">
    <field name="name">crm.lead.form.deadline.label</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="crm.crm_lead_view_form"/>
    <field name="arch" type="xml">
      <xpath expr="//sheet" position="inside">
        <group string="Cliente">
          <field name="becomes_customer"/>
          <field name="customer_image" widget="image" class="oe_avatar"/>
        </group>
      </xpath>
      <xpath expr="//field[@name='date_deadline']" position="attributes">
        <attribute name="string">Data visita prevista</attribute>
      </xpath>
    </field>
  </record>

  <record id="crm_lead_kanban_show_address" model="ir.ui.view">
    <field name="name">crm.lead.kanban.show.address</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="crm.crm_case_kanban_view_leads"/>
    <field name="arch" type="xml">
      <xpath expr="//templates/t[@t-name='kanban-box']//field[@name='partner_id']" position="replace">
        <field name="partner_name"/>
        <field name="street"/>
        <field name="zip"/>
        <field name="city"/>
        <field name="state_id"/>
        <field name="phone" widget="phone"/>
        <field name="mobile" widget="phone"/>
        <field name="date_deadline" widget="date" string="Data chiusura prevista"/>
      </xpath>

      <xpath expr="//templates/t[@t-name='kanban-box']//strong[contains(@class, 'o_kanban_record_title')]" position="attributes">
        <attribute name="class">o_kanban_record_title o_hidden</attribute>
      </xpath>

    </field>
  </record>




  <record id="crm_lead_search_add_state_country" model="ir.ui.view">
    <field name="name">crm.lead.search.add.state.country</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="crm.view_crm_case_opportunities_filter"/>
    <field name="arch" type="xml">
      <!-- Restrizione dei campi di ricerca visibili solo al manager vendite -->

      <xpath expr="//field[@name='team_id']" position="attributes">
        <attribute name="groups">sales_team.group_sale_manager</attribute>
      </xpath>
      <xpath expr="//field[@name='user_id']" position="attributes">
        <attribute name="groups">sales_team.group_sale_manager</attribute>
      </xpath>
      <xpath expr="//field[@name='country_id']" position="attributes">
        <attribute name="groups">sales_team.group_sale_manager</attribute>
      </xpath>
      <!-- Il campo Proprietà può essere esposto come property_id o company_id a seconda della versione -->
      <xpath expr="//field[@name='lead_properties'] | //field[@name='activity_state']" position="attributes">
        <attribute name="groups">sales_team.group_sale_manager</attribute>
      </xpath>

      <xpath expr="//search" position="inside">
        <!-- Campo Provincia disponibile a tutti per la ricerca -->
        <field name="state_id" string="provincia"/>
        <!-- Campo indirizzo sempre disponibile per la ricerca -->
        <field name="street" string="Indirizzo"/>
      </xpath>
    </field>
  </record>
</odoo>
